<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mater Misericordiae University Hospital</title>
  <meta name="description" content="Class of 1983">

  <style>
    :root{
      --bg:#0b0d10; --panel:#111418; --text:#e8eef2; --muted:#a8b3bd; --gap:1rem; --radius:14px;
      --max:1200px; --accent:#6bb1ff;
    }
    html,body{height:100%}
    body{margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:linear-gradient(180deg,#0d1116,#0b0d10); color:var(--text)}
    header{max-width:var(--max); margin:2rem auto 1rem; padding:0 1rem}
    header h1{margin:.2rem 0 .3rem; font-weight:700}
    header p{margin:0; color:var(--muted)}
    .wrap{max-width:var(--max); margin:0 auto 3rem; padding:0 1rem}

    /* Hero */
    .hero{background:var(--panel); border:1px solid #1a1f25; border-radius:var(--radius); overflow:hidden}
    .hero img{width:100%; height:auto; display:block; object-fit:contain; cursor:zoom-in}
    .hero figcaption{padding:.6rem .8rem; text-align:center; border-top:1px solid #1a1f25}
    .hero .actions{display:flex; gap:.5rem; justify-content:center; padding:.6rem .8rem; border-top:1px solid #1a1f25; background:rgba(0,0,0,.08)}
    .btn{appearance:none; border:1px solid #2a323a; background:#151a20; color:var(--text); padding:.5rem .8rem; border-radius:10px; cursor:pointer; font-size:.95rem; text-decoration:none}
    .btn:hover{background:#1a2027}

    /* Mobile hero box: 384px wide and centered */
    @media (max-width:640px){
      #hero{max-width:384px; margin-left:auto; margin-right:auto}
      #hero img{width:100%; height:auto; object-fit:cover}
    }

    /* Grid */
    .grid{ display:grid; gap:var(--gap); margin-top:1.25rem; grid-template-columns: repeat(5, 1fr); }
    /* Tablet */
    @media (max-width:1100px){ .grid{ grid-template-columns:repeat(4,1fr); } }
    @media (max-width:900px){  .grid{ grid-template-columns:repeat(3,1fr); } }
    /* Mobile: 4 columns */
    @media (max-width:640px){  .grid{ grid-template-columns:repeat(4,1fr); } }

    figure.card{margin:0; background:var(--panel); border:1px solid #1a1f25; border-radius:var(--radius); overflow:hidden}
    .thumb{ display:block; width:100%; height:auto; aspect-ratio: 2 / 2.828; object-fit: cover; transition: transform .2s ease }
    figure.card:hover .thumb{transform:scale(1.02)}
    figcaption{padding:.6rem .8rem; text-align:center; font-size:.95rem; color:var(--text); border-top:1px solid #1a1f25}

    /* See more button */
    .see-more-wrap{ display:none; margin-top:1rem; text-align:center; }
    @media (max-width:640px){ .see-more-wrap{ display:block; } }

    /* Lightbox */
    .lightbox{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.7); backdrop-filter:blur(6px); z-index:9999}
    .lightbox[aria-hidden="false"]{display:flex}
    .lb-stage{position:relative; width:min(96vw,1400px); height:min(92vh,900px); display:flex; align-items:center; justify-content:center}
    .lb-img{max-width:100%; max-height:100%; user-select:none; cursor:zoom-in; transition:transform .05s ease}
    .lb-zoomed{cursor:grab}
    .lb-caption{position:absolute; left:0; right:0; bottom:0; padding:.6rem 1rem; text-align:center; color:var(--text); background:linear-gradient(180deg,transparent,rgba(0,0,0,.75))}
    .lb-btn{position:absolute; top:50%; transform:translateY(-50%); background:rgba(17,20,24,.85); border:1px solid #2a323a; color:var(--text); width:44px; height:44px; border-radius:10px; font-size:22px}
    .prev{left:12px} .next{right:12px}
    .close{position:absolute; top:12px; right:12px; background:rgba(17,20,24,.85); border:1px solid #2a323a; color:var(--text); width:44px; height:44px; border-radius:10px}
    .help{position:absolute; top:12px; left:12px; color:var(--muted); font-size:.9rem; opacity:.85}
    .kbd{font-family:ui-monospace,Menlo,Consolas,monospace; background:#0e1318; border:1px solid #2a323a; padding:.05rem .35rem; border-radius:6px}
  </style>
</head>
<body>
  <header>
    <h1>Mater Misericordiae University Hospital - Class of '83</h1>
    <p>Click any image to view and zoom</p>
  </header>

  <div class="wrap">
    <!-- HERO / FULL CLASS -->
    <figure class="hero" id="hero">
      <img id="heroImg" src="" alt="Full class photograph" loading="eager" />
      <figcaption>Full class</figcaption>
      <div class="actions">
        <button id="openHero" class="btn" type="button" aria-label="View full size">View &amp; Zoom</button>
        <a id="downloadHero" class="btn" href="#" download="Full-Class.jpg" aria-label="Download full class photo">Download</a>
      </div>
    </figure>

    <!-- GRID -->
    <main class="grid" id="grid" aria-live="polite"></main>

    <!-- See more -->
    <div class="see-more-wrap">
      <button id="seeMoreBtn" class="btn" type="button" aria-expanded="false">See more</button>
    </div>
  </div>

  <!-- LIGHTBOX -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="lb-stage" id="stage">
      <img id="lbImg" class="lb-img" alt="" />
      <p id="lbCap" class="lb-caption" aria-live="polite"></p>
      <button class="lb-btn prev" id="prevBtn" aria-label="Previous image" title="Previous (←)">❮</button>
      <button class="lb-btn next" id="nextBtn" aria-label="Next image" title="Next (→)">❯</button>
      <button class="close" id="closeBtn" aria-label="Close (Esc)" title="Close (Esc)">✕</button>
      <div class="help">Tap/Click to <span class="kbd">zoom</span>; pinch to zoom on mobile; drag to pan; <span class="kbd">←</span>/<span class="kbd">→</span> to navigate</div>
    </div>
  </div>

  <script>
    // ===== CONFIG =====
    const BASE = '/med-class-1983/med-class-gallery/images/';
    const HERO_SRC = BASE + 'full-class.jpg';

    // ===== Portraits (simplified file names for repo) =====
    const PORTRAITS = [
      { file: 'MMH_John Barry.png', name: 'John Barry', alt: 'Photo of John Barry' },
      { file: 'MMH_Mary Cosgrave.png', name: 'Mary Cosgrave', alt: 'Photo of Mary Cosgrave' },
      // ... (keep your full list here)
      { file: 'MMH_David Tangney.png', name: 'David Tangney', alt: 'Photo of David Tangney' }
    ];

    // ===== Helpers =====
    function normaliseFile(file) {
      let p = (file || '');
      p = p.replace(/^image\//, '');
      p = p.replace(/^MMH_/, 'MMH__');
      return p;
    }

    // ===== DOM refs =====
    const grid = document.getElementById('grid');
    const heroImg = document.getElementById('heroImg');
    const openHeroBtn = document.getElementById('openHero');
    const downloadHero = document.getElementById('downloadHero');
    const seeMoreBtn = document.getElementById('seeMoreBtn');

    let mobileCapped = false;
    const MOBILE_MAX = 640;
    const MOBILE_VISIBLE_COUNT = 16;

    function makeFigure(src, caption, alt) {
      const fig = document.createElement('figure');
      fig.className = 'card';
      const img = document.createElement('img');
      img.className = 'thumb';
      img.src = src;
      img.alt = alt || caption || '';
      img.loading = 'lazy';
      img.decoding = 'async';
      const cap = document.createElement('figcaption');
      cap.textContent = caption || '';
      fig.appendChild(img);
      fig.appendChild(cap);
      return fig;
    }

    function renderGrid() {
      heroImg.src = HERO_SRC;
      downloadHero.href = HERO_SRC;
      PORTRAITS.forEach(item => {
        const path = normaliseFile(item.file);
        const src = encodeURI(BASE + path);
        grid.appendChild(makeFigure(src, item.name, item.alt));
      });
      wireLightbox();
      applyMobileCap();
    }

    // ===== Mobile cap for "See more" =====
    function isMobile(){ return window.matchMedia(`(max-width:${MOBILE_MAX}px)`).matches; }
    function applyMobileCap(){
      const cards = Array.from(document.querySelectorAll('#grid .card'));
      if (!isMobile()){
        cards.forEach(c => c.style.display = '');
        mobileCapped = false;
        seeMoreBtn.style.display = 'none';
        return;
      }
      cards.forEach((c, i) => { c.style.display = (i < MOBILE_VISIBLE_COUNT) ? '' : 'none'; });
      mobileCapped = true;
      seeMoreBtn.textContent = 'See more';
      seeMoreBtn.setAttribute('aria-expanded','false');
      seeMoreBtn.style.display = '';
    }
    function revealAll(){
      const cards = Array.from(document.querySelectorAll('#grid .card'));
      cards.forEach(c => c.style.display = '');
      mobileCapped = false;
      seeMoreBtn.textContent = 'See less';
      seeMoreBtn.setAttribute('aria-expanded','true');
    }
    function toggleSeeMore(){
      if (mobileCapped) revealAll(); else applyMobileCap();
    }

    // ===== Lightbox (simplified for brevity) =====
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbCap = document.getElementById('lbCap');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const closeBtn = document.getElementById('closeBtn');
    let items = [], index = 0;

    function wireLightbox(){
      const figs = Array.from(document.querySelectorAll('.grid figure'));
      items = figs.map(fig => {
        const img = fig.querySelector('img');
        const cap = fig.querySelector('figcaption');
        fig.onclick = () => openLB(figs.indexOf(fig)+1);
        return { src: img.src, alt: img.alt, caption: cap.textContent };
      });
      items.unshift({ src: HERO_SRC, alt: 'Full class photograph', caption: 'Full class' });
      heroImg.addEventListener('click', () => openLB(0));
      openHeroBtn.addEventListener('click', () => openLB(0));
    }

    function openLB(i){ index=i; updateLB(); lb.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }
    function closeLB(){ lb.setAttribute('aria-hidden','true'); document.body.style.overflow=''; }
    function updateLB(){ const it=items[index]; lbImg.src=it.src; lbCap.textContent=it.caption; }

    prevBtn.addEventListener('click', ()=>{index=(index-1+items.length)%items.length;updateLB();});
    nextBtn.addEventListener('click', ()=>{index=(index+1)%items.length;updateLB();});
    closeBtn.addEventListener('click', closeLB);
    lb.addEventListener('click', e=>{if(e.target===lb)closeLB();});

    if (seeMoreBtn) seeMoreBtn.addEventListener('click', toggleSeeMore);
    window.addEventListener('resize', applyMobileCap);
    window.addEventListener('orientationchange', applyMobileCap);

    document.addEventListener('DOMContentLoaded', renderGrid);
  </script>
</body>
</html>
